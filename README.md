# MLOPS_hw_1
First homework for MLOPS course, FTaDA, HSE Masters

Задание выполнено группой из одного человека - Аксенова Никиты Николаевича


## О проекте

Данный репозиторий содержит API для работы с ML моделями и дашборд для интерактивного взаимодействия. 
API реализован на FastAPI и поддерживает управление моделями LightGBM, их обучение, обучение заново, управление гиперпараметрами, инференс. 
Дашборд построен на Streamlit и обеспечивает работу с моделями через веб-интерфейс.

***

## Установка и запуск

### Запуск API

В терминале jupyter notebooks:
```
!fastapi dev ml_api.py
```

API будет запущен на `http://127.0.0.1:8000`.

### Запуск дашборда

```
streamlit run dashboard.py
```

***

## Использование API

### Список доступных моделей

- **GET /get_model_classes**

  Возвращает поддерживаемые типы моделей: `LGBMRegressor`, `LGBMClassifier`.

### Создание новой модели

- **POST /create_model**

  ```json
  {
    "model_type": "LGBMRegressor",
    "hyperparameters": {"learning_rate": 0.1, "n_estimators": 100}
  }
  ```
  Ответ содержит ID созданной модели и ее параметры.

### Получение списка моделей

- **GET /get_models**

  Возвращает список всех сохраненных моделей с их параметрами.

### Обучение модели

- **POST /train_model**

  ```json
  {
    "model_id": 0,
    "X_data": "[JSON данных X]",
    "Y_data": "[JSON данных Y]"
  }
  ```
  Происходит обучение модели с ID=model_id на предоставленных данных.
  В ответе выводится статус, id модели, метрики качества.

  Для вызова этой функции, сущность модели должна быть уже инициализирована ранее

### Создание и одновременное обучение новой модели

- **POST /train_new_model**

  ```json
  {
    "model_type": "LGBMClassifier",
    "hyperparameters": {...},
    "X_data": "[JSON данных X]",
    "Y_data": "[JSON данных Y]"
  }
  ```
  Создает и обучает модель за один запрос.
  В ответе выводится статус, id модели, метрики качества.

### Предсказания

- **POST /predict**

  ```json
  {
    "model_id": 0,
    "X_data": "[JSON для предсказания]"
  }
  ```
  Возвращает результат предсказания модели по входным данным X.

### Удаление модели

- **DELETE /delete_model/{modelid}**

  Очищает модель с заданным ID.

### Проверка статуса сервиса

- **GET /healthcheck**

  Возвращает статус работы сервиса и количество моделей[1].

***

## Использование дашборда

- Дашборд позволяет через боковое меню:
  - Просматривать доступные типы моделей
  - Создавать и настраивать модели, указывать гиперпараметры
  - Загружать данные для обучения и предсказания (в формате CSV)
  - Получать метрики и визуализировать предсказания (графики)
  - Удалять модели и смотреть статус API.

***

## Примеры запросов

### Пример создания модели

```bash
curl -X POST "http://127.0.0.1:8000/createmodel" \
-H "Content-Type: application/json" \
-d '{"modeltype":"LGBMRegressor","hyperparameters":{"learning_rate":0.05,"n_estimators":200}}'
```


### Пример обучения

```bash
curl -X POST "http://127.0.0.1:8000/trainmodel" \
-H "Content-Type: application/json" \
-d '{"model_id":0,"X_data":"JSON_X","Y_data":"JSON_Y"}'
```


***

## Логи и ошибки

Каждый запрос логируется и при ошибке возвращается статус и подробное сообщение (код 500).

***
